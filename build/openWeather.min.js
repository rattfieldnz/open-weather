/*!
 Name: Open Weather
 Dependencies: jQuery, OpenWeatherMap API
 Author: Michael Lynch
 Contributor: Robert Attfield
 Author URL: http://michaelynch.com
 Contributor URL: https://www.robertattfield.com
 Date Created: August 28, 2013
 Licensed under the MIT license
 */
!function(a){a.fn.openWeather=function(b){function l(a,b,c){if(null==c)return null;var d;if("Kph"===a&&"Mph"===b)d=c/1.609344;else if("Mph"===a&&"Kph"===b)d=1.609344*c;else if("Kph"===a&&"mps"===b)d=c/3.6;else if("Mph"===a&&"mps"===b)d=.44704*c;else if("mps"===a&&"Kph"===b)d=3.6*c;else{if("mps"!==a||"Mph"!==b)return c+" "+a;d=2.23693629*c}return parseFloat(d.toFixed(1))+" "+b}function m(a,b,c){if(null==c)return null;var d;if(c=parseInt(c),"imperial"===a&&"metric"===b)d=(c-32)/1.8;else if("metric"===a&&"imperial"===b)d=1.8*c+32;else if("standard"===a&&"imperial"===b)d=1.8*c-459.67;else if("imperial"===a&&"standard"===b)d=(c+459.67)*(5/9);else if("metric"===a&&"standard"===b)d=c+273.15;else{if("standard"!==a||"metric"!==b)return"metric"===a&&"metric"===b||"standard"===a&&"standard"===b||"imperial"===a&&"imperial"===b?c+o(b):parseFloat(c.toFixed(1))+o(a);d=c-273.15}return"undefined"!==d?parseFloat(d.toFixed(1))+o(b):void 0}function n(b){var c=["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"],d=null;return a.isNumeric(b)&&b>=0?(d=+Math.round((b/22.5+.5)%16),c[d-1]):null}function o(a){var b;if(null==a)return null;switch(a){case"metric":b="°C";break;case"imperial":b="°F";break;case"standard":b="°K"}return b}function p(a){var b;return"01d"!=a&&"01n"!=a||(b="clear"),"02d"!=a&&"02n"!=a&&"03d"!=a&&"03n"!=a&&"04d"!=a&&"04n"!=a||(b="clouds"),"09d"!=a&&"09n"!=a&&"10d"!=a&&"10n"!=a||(b="rain"),"11d"!=a&&"11n"!=a||(b="storm"),"13d"!=a&&"13n"!=a||(b="snow"),"50d"!=a&&"50n"!=a||(b="mist"),b}if(!this.length)return this;var c={shortDescriptionTarget:null,descriptionTarget:null,maxTemperatureTarget:null,minTemperatureTarget:null,windSpeedTarget:null,windDirectionTarget:null,humidityTarget:null,sunriseTarget:null,sunsetTarget:null,placeTarget:null,iconTarget:null,customIcons:null,customBackgroundImages:null,units:"metric",windSpeedUnit:"Kph",windDirectionUnit:"compass",clickConvertTemperature:!0,clickConvertWindDirection:!0,clickConvertWindSpeed:!0,city:null,lat:null,lng:null,key:null,lang:"en",timeLastUpdatedTarget:null,dayOrNightTarget:null,success:function(){},error:function(a){}},d=this,e=a(this);d.settings={},d.settings=a.extend({},c,b);var h,g=d.settings;a(e).is("#"+e.attr("id"))?h="#"+e.attr("id"):a(e).is("."+e.attr("class"))&&(h="."+e.attr("class"));var i=[h,g.minTemperatureTarget,g.maxTemperatureTarget],j={};null!=g.units&&(j.units=g.units),null!=g.city?j.q=g.city.replace(" ",""):null!=g.lat&&null!=g.lng&&(paramaters.lat=g.lat,paramaters.lng=g.lng),null!=g.key&&(j.appid=g.key);var k=function(a){var b=1e3*a,c=new Date(b),d=c.getHours(),e=c.getMinutes(),f=d>=12?"PM":"AM";return d%=12,d=d?d:12,e=e<10?"0"+e:e,d+":"+e+" "+f};a.ajax({url:"https://proxy.hackeryou.com",dataType:"json",method:"GET",data:{reqUrl:"http://api.openweathermap.org/data/2.5/weather",params:j,xmlToJSON:!1},success:function(b){var c,d,f,h=function(){var a=new Date(1e3*b.dt),c=new Date(1e3*b.sys.sunrise),d=new Date(1e3*b.sys.sunset);return j(a)>j(c)&&j(a)<j(d)?"day":"night"},j=function(a){return a.getSeconds()+60*a.getMinutes()+60*a.getHours()*60};if(c=Math.round(b.main.temp)+o(g.units),d=Math.round(b.main.temp_min)+o(g.units),f=Math.round(b.main.temp_max)+o(g.units),e.html(c),1==g.clickConvertTemperature){var q=0,r=["metric","imperial","standard"],s=a(e).text().substring(0,a(e).text().length-2);f=parseFloat(f.substring(0,f.length-2)),d=parseFloat(d.substring(0,d.length-2));for(var t=0;t<i.length;t++)a(i[t]).on("click",function(){var b=r[q%r.length],c=m(g.units,b,s),h=m(g.units,b,f),i=m(g.units,b,d);null!=e&&a(e).text(c),null!=g.minTemperatureTarget&&a(g.minTemperatureTarget).text(i),null!=g.maxTemperatureTarget&&a(g.maxTemperatureTarget).text(h),q++})}if(null!=g.minTemperatureTarget&&a(g.minTemperatureTarget).text(d+o(g.units)),null!=g.maxTemperatureTarget&&a(g.maxTemperatureTarget).text(f+o(g.units)),null!=g.shortDescriptionTarget&&a(g.shortDescriptionTarget).text(b.weather[0].main),null!=g.descriptionTarget&&a(g.descriptionTarget).text(b.weather[0].description),null!=g.iconTarget&&null!=b.weather[0].icon){if(null!=g.customIcons)var u=b.weather[0].icon,v=h(),w=g.customIcons+v+"/"+p(u)+".png";else var w="http://openweathermap.org/img/w/"+b.weather[0].icon+".png";a(g.iconTarget).attr("src",w)}if(null!=g.customBackgroundImages&&null!=b.weather[0].main){var y,x=b.weather[0].icon;v=h(),y=g.customBackgroundImages+v+"/"+p(x)+".jpg",a("html").css("height","100%"),a("body").css({height:"100%","background-image":"url("+y+")","background-attachment":"fixed","background-repeat":"no-repeat","-webkit-background-size":"cover","-moz-background-size":"cover","-o-background-size":"cover","background-size":"cover","background-position":"center fixed"})}if(null!=g.placeTarget&&a(g.placeTarget).text(b.name+", "+b.sys.country),null!=g.windSpeedTarget){var z;switch(g.windSpeedUnit){case"mps":z=b.wind.speed;break;case"Mph":z=b.wind.speed/.44704;break;case"Kph":z=3.6*b.wind.speed}if(a(g.windSpeedTarget).text(parseFloat(z.toFixed(1))+" "+g.windSpeedUnit),1==g.clickConvertWindSpeed){var A=0,B=parseFloat(a(g.windSpeedTarget).text().substring(0,4)),C=["Kph","Mph","mps"];a(g.windSpeedTarget).on("click",function(b){A++;var c=C[A%C.length],d=l(g.windSpeedUnit,c,B);a(g.windSpeedTarget).text(d)})}}if(null!=g.windDirectionTarget){var D=b.wind.deg;if("degrees"===g.windDirectionUnit&&a(g.windDirectionTarget).text(D.toFixed(1)+"°"),"compass"===g.windDirectionUnit){if(a.isNumeric(D)&&D>=0){var E=n(D);a(g.windDirectionTarget).text(E)}}else a(g.windDirectionTarget).text(D.toFixed(1)+"°");if(1==g.clickConvertWindDirection){var F=0,G=["degrees","compass"];a(g.windDirectionTarget).on("click",function(){F++;var b=G[F%G.length];if("degrees"===b){var c=n(D);a(g.windDirectionTarget).text(c)}else"compass"===b&&a(g.windDirectionTarget).text(D.toFixed(1)+"°")})}}if(null!=g.humidityTarget&&a(g.humidityTarget).text(b.main.humidity+"%"),null!=g.sunriseTarget){var H=k(b.sys.sunrise);a(g.sunriseTarget).text(H)}if(null!=g.sunsetTarget){var I=k(b.sys.sunset);a(g.sunsetTarget).text(I)}if(null!=g.timeLastUpdatedTarget){var J=k(b.dt);a(g.timeLastUpdatedTarget).text(J)}null!=g.dayOrNightTarget&&(a(g.dayOrNightTarget).text(h()),console.log(h())),g.success.call(this)},error:function(a,b,c){g.error.call(this,b)}})}}(jQuery);
