/*!

 Name: Open Weather
 Dependencies: jQuery, OpenWeatherMap API
 Author: Michael Lynch
 Author URL: http://michaelynch.com
 Date Created: August 28, 2013
 Licensed under the MIT license

 */
!function(e){e.fn.openWeather=function(n){if(!this.length)return this;var t,r={descriptionTarget:null,maxTemperatureTarget:null,minTemperatureTarget:null,windSpeedTarget:null,windDirection:null,humidityTarget:null,sunriseTarget:null,sunsetTarget:null,placeTarget:null,iconTarget:null,customIcons:null,units:"c",city:null,lat:null,lng:null,key:null,lang:"en",success:function(){},error:function(e){}},a=this,i=e(this);a.settings={},a.settings=e.extend({},r,n);var l=a.settings;t="//api.openweathermap.org/data/2.5/weather?lang="+l.lang,null!=l.city?t+="&q="+l.city.replace(" ",""):null!=l.lat&&null!=l.lng&&(t+="&lat="+l.lat+"&lon="+l.lng),null!=l.key&&(t+="&appid="+l.key);var u=function(e){var n=1e3*e,t=new Date(n),r=t.getHours();r>12&&(hoursRemaining=24-r,r=12-hoursRemaining);var a=t.getMinutes();a=a.toString(),a.length<2&&(a=0+a);var i=r+":"+a;return i};e.ajax({type:"GET",url:t,dataType:"jsonp",success:function(n){if("f"==l.units)var t=Math.round(1.8*(n.main.temp-273.15)+32)+"°F",r=Math.round(1.8*(n.main.temp_min-273.15)+32)+"°F",a=Math.round(1.8*(n.main.temp_max-273.15)+32)+"°F";else var t=Math.round(n.main.temp-273.15)+"°C",r=Math.round(n.main.temp_min-273.15)+"°C",a=Math.round(n.main.temp_max-273.15)+"°C";if(i.html(t),null!=l.minTemperatureTarget&&e(l.minTemperatureTarget).text(r),null!=l.maxTemperatureTarget&&e(l.maxTemperatureTarget).text(a),e(l.descriptionTarget).text(n.weather[0].description),null!=l.iconTarget&&null!=n.weather[0].icon){if(null!=l.customIcons){var s,o,g=n.weather[0].icon;o=-1!=g.indexOf("d")?"day":"night",("01d"==g||"01n"==g)&&(s="clear"),("02d"==g||"02n"==g||"03d"==g||"03n"==g||"04d"==g||"04n"==g)&&(s="clouds"),("09d"==g||"09n"==g||"10d"==g||"10n"==g)&&(s="rain"),("11d"==g||"11n"==g)&&(s="storm"),("13d"==g||"13n"==g)&&(s="snow"),("50d"==g||"50n"==g)&&(s="mist");var c=l.customIcons+o+"/"+s+".png"}else var c="http://openweathermap.org/img/w/"+n.weather[0].icon+".png";e(l.iconTarget).attr("src",c)}if(null!=l.placeTarget&&e(l.placeTarget).text(n.name+", "+n.sys.country),null!=l.windSpeedTarget&&e(l.windSpeedTarget).text(Math.round(n.wind.speed)+" Mps"),null!=l.windDirection&&e(l.windDirection).text(n.wind.deg),null!=l.humidityTarget&&e(l.humidityTarget).text(n.main.humidity+"%"),null!=l.sunriseTarget){var m=u(n.sys.sunrise);e(l.sunriseTarget).text(m+" AM")}if(null!=l.sunsetTarget){var d=u(n.sys.sunset);e(l.sunsetTarget).text(d+" PM")}l.success.call(this)},error:function(e,n,t){l.error.call(this,n)}})}}(jQuery);
