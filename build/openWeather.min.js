/*!

 Name: Open Weather
 Dependencies: jQuery, OpenWeatherMap API
 Author: Michael Lynch
 Author URL: http://michaelynch.com
 Date Created: August 28, 2013
 Licensed under the MIT license

 */
!function(a){a.fn.openWeather=function(b){if(!this.length)return this;var f,c={descriptionTarget:null,maxTemperatureTarget:null,minTemperatureTarget:null,windSpeedTarget:null,windDirection:null,humidityTarget:null,sunriseTarget:null,sunsetTarget:null,placeTarget:null,iconTarget:null,customIcons:null,units:"c",city:null,lat:null,lng:null,key:null,lang:"en",success:function(){},error:function(a){}},d=this,e=a(this);d.settings={},d.settings=a.extend({},c,b);var g=d.settings;f="//api.openweathermap.org/data/2.5/weather?lang="+g.lang,null!=g.city?f+="&q="+g.city.replace(" ",""):null!=g.lat&&null!=g.lng&&(f+="&lat="+g.lat+"&lon="+g.lng),null!=g.key&&(f+="&appid="+g.key);var h=function(a){var b=1e3*a,c=new Date(b),d=c.getHours();d>12&&(hoursRemaining=24-d,d=12-hoursRemaining);var e=c.getMinutes();e=e.toString(),e.length<2&&(e=0+e);var f=d+":"+e;return f};a.ajax({type:"GET",url:f,dataType:"jsonp",success:function(b){if("f"==g.units)var c=Math.round(1.8*(b.main.temp-273.15)+32)+"°F",d=Math.round(1.8*(b.main.temp_min-273.15)+32)+"°F",f=Math.round(1.8*(b.main.temp_max-273.15)+32)+"°F";else var c=Math.round(b.main.temp-273.15)+"°C",d=Math.round(b.main.temp_min-273.15)+"°C",f=Math.round(b.main.temp_max-273.15)+"°C";if(e.html(c),null!=g.minTemperatureTarget&&a(g.minTemperatureTarget).text(d),null!=g.maxTemperatureTarget&&a(g.maxTemperatureTarget).text(f),a(g.descriptionTarget).text(b.weather[0].description),null!=g.iconTarget&&null!=b.weather[0].icon){if(null!=g.customIcons){var j,k,i=b.weather[0].icon;k=i.indexOf("d")!=-1?"day":"night","01d"!=i&&"01n"!=i||(j="clear"),"02d"!=i&&"02n"!=i&&"03d"!=i&&"03n"!=i&&"04d"!=i&&"04n"!=i||(j="clouds"),"09d"!=i&&"09n"!=i&&"10d"!=i&&"10n"!=i||(j="rain"),"11d"!=i&&"11n"!=i||(j="storm"),"13d"!=i&&"13n"!=i||(j="snow"),"50d"!=i&&"50n"!=i||(j="mist");var l=g.customIcons+k+"/"+j+".png"}else var l="http://openweathermap.org/img/w/"+b.weather[0].icon+".png";a(g.iconTarget).attr("src",l)}if(null!=g.placeTarget&&a(g.placeTarget).text(b.name+", "+b.sys.country),null!=g.windSpeedTarget&&a(g.windSpeedTarget).text(Math.round(b.wind.speed)+" Mps"),null!=g.windDirection&&a(g.windDirection).text(b.wind.deg),null!=g.humidityTarget&&a(g.humidityTarget).text(b.main.humidity+"%"),null!=g.sunriseTarget){var m=h(b.sys.sunrise);a(g.sunriseTarget).text(m+" AM")}if(null!=g.sunsetTarget){var n=h(b.sys.sunset);a(g.sunsetTarget).text(n+" PM")}g.success.call(this)},error:function(a,b,c){g.error.call(this,b)}})}}(jQuery);
